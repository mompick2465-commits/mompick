/*! For license information please see 693.2d8c0d4d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkmompick=self.webpackChunkmompick||[]).push([[693],{403:(e,t,o)=>{var n;o.d(t,{E_:()=>c,F3:()=>a,Ii:()=>i}),function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(n||(n={}));class r extends Error{constructor(e,t,o){super(e),this.message=e,this.code=t,this.data=o}}const s=e=>{const t=e.CapacitorCustomPlatform||null,o=e.Capacitor||{},s=o.Plugins=o.Plugins||{},i=()=>null!==t?t.name:(e=>{var t,o;return(null===e||void 0===e?void 0:e.androidBridge)?"android":(null===(o=null===(t=null===e||void 0===e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===o?void 0:o.bridge)?"ios":"web"})(e),a=e=>{var t;return null===(t=o.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)},c=new Map;return o.convertFileSrc||(o.convertFileSrc=e=>e),o.getPlatform=i,o.handleError=t=>e.console.error(t),o.isNativePlatform=()=>"web"!==i(),o.isPluginAvailable=e=>{const t=c.get(e);return!!(null===t||void 0===t?void 0:t.platforms.has(i()))||!!a(e)},o.registerPlugin=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=c.get(e);if(d)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),d.proxy;const u=i(),g=a(e);let m;const f=s=>{let i;const a=function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];const f=(async()=>(!m&&u in l?m=m="function"===typeof l[u]?await l[u]():l[u]:null!==t&&!m&&"web"in l&&(m=m="function"===typeof l.web?await l.web():l.web),m))().then(t=>{const a=((t,s)=>{var i,a;if(!g){if(t)return null===(a=t[s])||void 0===a?void 0:a.bind(t);throw new r('"'.concat(e,'" plugin is not implemented on ').concat(u),n.Unimplemented)}{const n=null===g||void 0===g?void 0:g.methods.find(e=>s===e.name);if(n)return"promise"===n.rtype?t=>o.nativePromise(e,s.toString(),t):(t,n)=>o.nativeCallback(e,s.toString(),t,n);if(t)return null===(i=t[s])||void 0===i?void 0:i.bind(t)}})(t,s);if(a){const e=a(...c);return i=null===e||void 0===e?void 0:e.remove,e}throw new r('"'.concat(e,".").concat(s,'()" is not implemented on ').concat(u),n.Unimplemented)});return"addListener"===s&&(f.remove=async()=>i()),f};return a.toString=()=>"".concat(s.toString(),"() { [capacitor code] }"),Object.defineProperty(a,"name",{value:s,writable:!1,configurable:!1}),a},h=f("addListener"),p=f("removeListener"),v=(e,t)=>{const o=h({eventName:e},t),n=async()=>{const n=await o;p({eventName:e,callbackId:n},t)},r=new Promise(e=>o.then(()=>e({remove:n})));return r.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await n()},r},w=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?v:h;case"removeListener":return p;default:return f(t)}}});return s[e]=w,c.set(e,{name:e,proxy:w,platforms:new Set([...Object.keys(l),...g?[u]:[]])}),w},o.Exception=r,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o},i=(e=>e.Capacitor=s(e))("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof o.g?o.g:{}),a=i.registerPlugin;class c{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let o=!1;this.listeners[e]||(this.listeners[e]=[],o=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),o&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,o){const n=this.listeners[e];if(n)n.forEach(e=>e(t));else if(o){let o=this.retainedEventArguments[e];o||(o=[]),o.push(t),this.retainedEventArguments[e]=o}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not implemented";return new i.Exception(e,n.Unimplemented)}unavailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not available";return new i.Exception(e,n.Unavailable)}async removeListener(e,t){const o=this.listeners[e];if(!o)return;const n=o.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}const l=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),d=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class u extends c{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[o,n]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=d(o).trim(),n=d(n).trim(),t[o]=n}),t}async setCookie(e){try{const t=l(e.key),o=l(e.value),n="; expires=".concat((e.expires||"").replace("expires=","")),r=(e.path||"/").replace("path=",""),s=null!=e.url&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(o||"").concat(n,"; path=").concat(r,"; ").concat(s,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat((new Date).toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}a("CapacitorCookies",{web:()=>new u});const g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=Object.assign({method:e.method||"GET",headers:e.headers},t),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((o,n,r)=>(o[n]=e[t[r]],o),{})}(e.headers),r=n["content-type"]||"";if("string"===typeof e.data)o.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[o,n]of Object.entries(e.data||{}))t.set(o,n);o.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,o)=>{t.append(o,e)});else for(const o of Object.keys(e.data))t.append(o,e.data[o]);o.body=t;const n=new Headers(o.headers);n.delete("content-type"),o.headers=n}else(r.includes("application/json")||"object"===typeof e.data)&&(o.body=JSON.stringify(e.data));return o};class m extends c{async request(e){const t=g(e,e.webFetchExtra),o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?Object.entries(e).reduce((e,o)=>{const[n,r]=o;let s,i;return Array.isArray(r)?(i="",r.forEach(e=>{s=t?encodeURIComponent(e):e,i+="".concat(n,"=").concat(s,"&")}),i.slice(0,-1)):(s=t?encodeURIComponent(r):r,i="".concat(n,"=").concat(s)),"".concat(e,"&").concat(i)},"").substr(1):null}(e.params,e.shouldEncodeUrlParams),n=o?"".concat(e.url,"?").concat(o):e.url,r=await fetch(n,t),s=r.headers.get("content-type")||"";let i,a,{responseType:c="text"}=r.ok?e:{};switch(s.includes("application/json")&&(c="json"),c){case"arraybuffer":case"blob":a=await r.blob(),i=await(async e=>new Promise((t,o)=>{const n=new FileReader;n.onload=()=>{const e=n.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},n.onerror=e=>o(e),n.readAsDataURL(e)}))(a);break;case"json":i=await r.json();break;default:i=await r.text()}const l={};return r.headers.forEach((e,t)=>{l[t]=e}),{data:i,headers:l,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}a("CapacitorHttp",{web:()=>new m})},693:(e,t,o)=>{o.d(t,{initializeFCM:()=>c});var n=o(403);const r=(0,n.F3)("PushNotifications",{}),s=(0,n.F3)("Device",{web:()=>o.e(950).then(o.bind(o,569)).then(e=>new e.DeviceWeb)});var i=o(801);let a=!1;const c=async()=>{const e=n.Ii.getPlatform();if(console.log("\ud83d\udd14 FCM \ucd08\uae30\ud654 \uc2dc\uc791 - \ud50c\ub7ab\ud3fc:",e),"web"!==e)try{console.log("\ud83d\udd14 \uad8c\ud55c \ud655\uc778 \uc911...");let e=await r.checkPermissions();if(console.log("\ud83d\udd14 \ud604\uc7ac \uad8c\ud55c \uc0c1\ud0dc:",e),"prompt"===e.receive&&(console.log("\ud83d\udd14 \uad8c\ud55c \uc694\uccad \uc911..."),e=await r.requestPermissions(),console.log("\ud83d\udd14 \uad8c\ud55c \uc694\uccad \uacb0\uacfc:",e)),"granted"!==e.receive)return void console.error("\u274c \ud478\uc2dc \uc54c\ub9bc \uad8c\ud55c\uc774 \uac70\ubd80\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc0c1\ud0dc:",e.receive);console.log("\u2705 \ud478\uc2dc \uc54c\ub9bc \uad8c\ud55c \uc2b9\uc778\ub428"),a?console.log("\u2139\ufe0f FCM \ub9ac\uc2a4\ub108\ub294 \uc774\ubbf8 \ub4f1\ub85d\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."):(console.log("\ud83d\udd14 FCM \ub9ac\uc2a4\ub108 \ub4f1\ub85d \uc911..."),r.addListener("registration",async e=>{console.log("\u2705 FCM \ud1a0\ud070 \uc218\uc2e0:",e.value),console.log("\ud83d\udd14 \ud1a0\ud070 \uc800\uc7a5 \uc2dc\uc791..."),await l(e.value)}),r.addListener("registrationError",e=>{console.error("\u274c FCM \ud1a0\ud070 \ub4f1\ub85d \uc624\ub958:",e)}),r.addListener("pushNotificationReceived",e=>{console.log("\ud83d\udcf1 \ud478\uc2dc \uc54c\ub9bc \uc218\uc2e0 (\ud3ec\uadf8\ub77c\uc6b4\ub4dc):",e)}),r.addListener("pushNotificationActionPerformed",e=>{console.log("\ud83d\udc46 \ud478\uc2dc \uc54c\ub9bc \ud074\ub9ad:",e)}),a=!0,console.log("\u2705 FCM \ub9ac\uc2a4\ub108 \ub4f1\ub85d \uc644\ub8cc")),console.log("\ud83d\udd14 PushNotifications.register() \ud638\ucd9c \uc911..."),await r.register(),console.log("\u2705 PushNotifications.register() \uc644\ub8cc - \ud1a0\ud070\uc740 registration \ub9ac\uc2a4\ub108\uc5d0\uc11c \ubc1b\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),console.log("\u2705 FCM \ucd08\uae30\ud654 \uc644\ub8cc")}catch(t){console.error("\u274c FCM \ucd08\uae30\ud654 \uc624\ub958:",t),console.error("\u274c \uc624\ub958 \uc0c1\uc138:",JSON.stringify(t,null,2))}else console.log("\uc6f9 \ud50c\ub7ab\ud3fc\uc5d0\uc11c\ub294 FCM\uc744 \ucd08\uae30\ud654\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")},l=async e=>{try{console.log("\ud83d\udd14 saveFCMToken \uc2dc\uc791 - \ud1a0\ud070:",e.substring(0,20)+"...");const{data:{user:t},error:o}=await i.supabase.auth.getUser();if(console.log("\ud83d\udd14 Auth \uc0ac\uc6a9\uc790 \ud655\uc778:",t?"\uc788\uc74c (".concat(t.id,")"):"\uc5c6\uc74c"),o&&console.error("\u274c Auth \uc0ac\uc6a9\uc790 \uc870\ud68c \uc624\ub958:",o),!t){console.log("\ud83d\udd14 OAuth \uc0ac\uc6a9\uc790 \uc5c6\uc74c, \uc804\ud654\ubc88\ud638 \ub85c\uadf8\uc778 \ud655\uc778 \uc911...");const t=localStorage.getItem("isLoggedIn"),o=localStorage.getItem("userProfile");if(console.log("\ud83d\udd14 localStorage \ud655\uc778:",{isLoggedIn:t,hasUserProfile:!!o}),"true"!==t||!o)return void console.error("\u274c \ub85c\uadf8\uc778\ub418\uc9c0 \uc54a\uc740 \uc0ac\uc6a9\uc790\uc785\ub2c8\ub2e4. \ud1a0\ud070 \uc800\uc7a5 \ubd88\uac00.");const n=JSON.parse(o);return console.log("\ud83d\udd14 \ud504\ub85c\ud544 ID (\uc804\ud654\ubc88\ud638):",n.id),void await d(n.id,e)}console.log("\ud83d\udd14 \ud504\ub85c\ud544 \uc870\ud68c \uc911... (auth_user_id:",t.id,")");const{data:n,error:r}=await i.supabase.from("profiles").select("id").eq("auth_user_id",t.id).maybeSingle();if(r)return void console.error("\u274c \ud504\ub85c\ud544 \uc870\ud68c \uc624\ub958:",r);if(!n)return void console.error("\u274c \ud504\ub85c\ud544\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");console.log("\ud83d\udd14 \ud504\ub85c\ud544 ID (OAuth):",n.id),await d(n.id,e)}catch(t){console.error("\u274c FCM \ud1a0\ud070 \uc800\uc7a5 \uc624\ub958:",t),console.error("\u274c \uc624\ub958 \uc0c1\uc138:",JSON.stringify(t,null,2))}},d=async(e,t)=>{try{const a="ios"===n.Ii.getPlatform()?"ios":"android";let c=null;try{c=(await s.getId()).identifier||null,console.log("\ud83d\udd14 \uae30\uae30 ID:",c)}catch(r){console.warn("\u26a0\ufe0f \uae30\uae30 ID \uac00\uc838\uc624\uae30 \uc2e4\ud328:",r)}console.log("\ud83d\udd14 saveTokenForProfile \uc2dc\uc791:",{profileId:e,platform:a,deviceId:c,tokenLength:t.length});let l=null,d=null;if(c){const t=await i.supabase.from("fcm_tokens").select("id, user_id, token, device_id").eq("user_id",e).eq("device_id",c).maybeSingle();l=t.data,d=t.error}else{const t=await i.supabase.from("fcm_tokens").select("id, user_id, token, device_id").eq("user_id",e).is("device_id",null).maybeSingle();l=t.data,d=t.error}d&&"PGRST116"!==d.code&&console.error("\u274c \uae30\uae30\ubcc4 \ud1a0\ud070 \ud655\uc778 \uc624\ub958:",d);const{data:u,error:g}=await i.supabase.from("fcm_tokens").select("id, user_id, token, device_id").eq("token",t).maybeSingle();if(g&&"PGRST116"!==g.code)return void console.error("\u274c \ud1a0\ud070 \ud655\uc778 \uc624\ub958:",g);if(console.log("\ud83d\udd14 \uae30\uc874 \ud1a0\ud070 \ud655\uc778:",{"\uac19\uc740\uae30\uae30\ud1a0\ud070":l?"\uc788\uc74c (token: ".concat(l.token.substring(0,20),"...)"):"\uc5c6\uc74c","\uac19\uc740\ud1a0\ud070":u?"\uc788\uc74c (user_id: ".concat(u.user_id,", device_id: ").concat(u.device_id,")"):"\uc5c6\uc74c"}),l&&l.token===t){console.log("\ud83d\udd14 \uac19\uc740 \uae30\uae30, \uac19\uc740 \uc0ac\uc6a9\uc790, \uac19\uc740 \ud1a0\ud070 - \uc5c5\ub370\uc774\ud2b8\ub9cc");const{data:e,error:t}=await i.supabase.from("fcm_tokens").update({platform:a,updated_at:(new Date).toISOString()}).eq("id",l.id).select();return void(t?console.error("\u274c FCM \ud1a0\ud070 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",t):console.log("\u2705 FCM \ud1a0\ud070 \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc:",e))}if(l&&l.token!==t){console.log("\ud83d\udd14 \uac19\uc740 \uae30\uae30, \uac19\uc740 \uc0ac\uc6a9\uc790, \ub2e4\ub978 \ud1a0\ud070 - \uae30\uc874 \ud1a0\ud070 \uc0ad\uc81c \ud6c4 \uc0c8 \ud1a0\ud070 \ub4f1\ub85d");const{error:e}=await i.supabase.from("fcm_tokens").delete().eq("id",l.id);e?console.error("\u274c \uae30\uc874 \ud1a0\ud070 \uc0ad\uc81c \uc624\ub958:",e):console.log("\u2705 \uae30\uc874 \ud1a0\ud070 \uc0ad\uc81c \uc644\ub8cc")}if(u){const o=u.user_id!==e,n=u.device_id!==c;if(o||n){console.log("\ud83d\udd14 \uac19\uc740 \ud1a0\ud070\uc774 \ub2e4\ub978 \uc0ac\uc6a9\uc790/\uae30\uae30\uc5d0\uac8c \uc788\uc74c - \uc774\uc804 \ud1a0\ud070 \uc0ad\uc81c \ud6c4 \uc0c8\ub85c \ub4f1\ub85d");const{error:e}=await i.supabase.from("fcm_tokens").delete().eq("token",t);e?console.error("\u274c \uc774\uc804 \ud1a0\ud070 \uc0ad\uc81c \uc624\ub958:",e):console.log("\u2705 \uc774\uc804 \uc0ac\uc6a9\uc790/\uae30\uae30 \ud1a0\ud070 \uc0ad\uc81c \uc644\ub8cc")}}console.log("\ud83d\udd14 \uc0c8 \ud1a0\ud070 \uc0bd\uc785 \uc911...");const{data:m,error:f}=await i.supabase.from("fcm_tokens").insert({user_id:e,token:t,platform:a,device_id:c}).select();var o;if(f)if("23505"===f.code){console.log("\u2139\ufe0f \uc911\ubcf5 \ud0a4 \uc624\ub958 \ubc1c\uc0dd - \uc5c5\ub370\uc774\ud2b8\ub85c \uc7ac\uc2dc\ub3c4");const{data:o,error:n}=await i.supabase.from("fcm_tokens").update({user_id:e,platform:a,device_id:c,updated_at:(new Date).toISOString()}).eq("token",t).select();n?console.error("\u274c FCM \ud1a0\ud070 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",n):console.log("\u2705 FCM \ud1a0\ud070 \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc:",o)}else console.error("\u274c FCM \ud1a0\ud070 \uc800\uc7a5 \uc624\ub958:",f),console.error("\u274c \uc800\uc7a5 \uc624\ub958 \uc0c1\uc138:",JSON.stringify(f,null,2));else console.log("\u2705 FCM \ud1a0\ud070 \uc800\uc7a5 \uc644\ub8cc:",m),console.log("\u2705 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub41c \ud1a0\ud070 ID:",null===m||void 0===m||null===(o=m[0])||void 0===o?void 0:o.id)}catch(a){console.error("\u274c FCM \ud1a0\ud070 \uc800\uc7a5 \uc911 \uc624\ub958:",a),console.error("\u274c \uc624\ub958 \uc0c1\uc138:",JSON.stringify(a,null,2))}}}}]);
//# sourceMappingURL=693.2d8c0d4d.chunk.js.map